
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="JsDoc" />
    <link rel="stylesheet" href="../css/style.css" type="text/css">
    <link rel="stylesheet" href="../css/doc.css" type="text/css">
    <link rel="stylesheet" href="../css/font-awesome-4.7.0.min.css" type="text/css">
    <link rel="shortcut icon" type="image/vnd.microsoft.icon" href="../images/logotype-icon.ico">
    <link rel="icon" type="image/png" sizes="256x256" href="../images/logotype-icon-256x256.png">
    <link rel="apple-touch-icon" sizes="256x256" href="../images/logotype-icon-256x256.png">
    <title>RapidContext :: JavaScript API</title>
  </head>
  <body class="doc">

    <section class="header">
      <div class="center">
        <a href="https://www.rapidcontext.com/" class="logotype">
          <img src="../images/logotype.png" />
        </a>
        <div class="text">
          <a href="https://www.rapidcontext.com/">
            <span style="font-size: 3.6em;">RapidContext</span><br>
            <span style="font-size: 1.75em; color: #caf3ff;">Access &#183; Discovery &#183; Insight</span><br>
            <span style="font-size: 1.3em; letter-spacing: 0.34em; line-height: 1.8em;">www.rapidcontext.com</span>
          </a>
        </div>
      </div>
      <div class="menu">
        <a href="https://www.rapidcontext.com/doc/index.html">Docs</a>
        &bull; <a href="https://github.com/cederberg/rapidcontext/releases">Downloads</a>
        &bull; <a href="https://github.com/cederberg/rapidcontext">Project</a>
      </div>
    </section>

    <section class="content center">
      <ol class="breadcrumb">
        <li><a href="../index.html">Documentation</a></li>

        <li><a href="index.html">JavaScript API</a></li>
        <li class="active">RapidContext_Encode.js</li>

      </ol>

      <div class="jsdoc">
        <h1 class="classTitle">Source RapidContext_Encode.js</h1>




    <section>
        <article>
            <pre><code class="hljs language-js"><span id="line1" class="lineno">1</span><span class="hljs-comment">/*
<span id="line2" class="lineno">2</span> * RapidContext &lt;https://www.rapidcontext.com/&gt;
<span id="line3" class="lineno">3</span> * Copyright (c) 2007-2023 Per Cederberg. All rights reserved.
<span id="line4" class="lineno">4</span> *
<span id="line5" class="lineno">5</span> * This program is free software: you can redistribute it and/or
<span id="line6" class="lineno">6</span> * modify it under the terms of the BSD license.
<span id="line7" class="lineno">7</span> *
<span id="line8" class="lineno">8</span> * This program is distributed in the hope that it will be useful,
<span id="line9" class="lineno">9</span> * but WITHOUT ANY WARRANTY; without even the implied warranty of
<span id="line10" class="lineno">10</span> * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.
<span id="line11" class="lineno">11</span> *
<span id="line12" class="lineno">12</span> * See the RapidContext LICENSE for more details.
<span id="line13" class="lineno">13</span> */</span>
<span id="line14" class="lineno">14</span>
<span id="line15" class="lineno">15</span><span class="hljs-comment">/**
<span id="line16" class="lineno">16</span> * Provides functions for encoding and decoding data.
<span id="line17" class="lineno">17</span> * <span class="hljs-doctag">@namespace</span> RapidContext.Encode
<span id="line18" class="lineno">18</span> */</span>
<span id="line19" class="lineno">19</span>(<span class="hljs-keyword">function</span> (<span class="hljs-params"><span class="hljs-variable language_">window</span></span>) {
<span id="line20" class="lineno">20</span>
<span id="line21" class="lineno">21</span>    <span class="hljs-comment">/**
<span id="line22" class="lineno">22</span>     * Returns the unicode escape sequence for a character.
<span id="line23" class="lineno">23</span>     *
<span id="line24" class="lineno">24</span>     * <span class="hljs-doctag">@param</span> {<span class="hljs-type">string</span>} chr the single character string
<span id="line25" class="lineno">25</span>     * <span class="hljs-doctag">@return</span> {<span class="hljs-type">string</span>} the unicode escape sequence
<span id="line26" class="lineno">26</span>     * <span class="hljs-doctag">@private</span>
<span id="line27" class="lineno">27</span>     */</span>
<span id="line28" class="lineno">28</span>    <span class="hljs-keyword">function</span> <span class="hljs-title function_">toCharEscape</span>(<span class="hljs-params">chr</span>) {
<span id="line29" class="lineno">29</span>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;\\u&quot;</span> + chr.<span class="hljs-title function_">charCodeAt</span>(<span class="hljs-number">0</span>).<span class="hljs-title function_">toString</span>(<span class="hljs-number">16</span>).<span class="hljs-title function_">padStart</span>(<span class="hljs-number">4</span>, <span class="hljs-string">&quot;0&quot;</span>);
<span id="line30" class="lineno">30</span>    }
<span id="line31" class="lineno">31</span>
<span id="line32" class="lineno">32</span>    <span class="hljs-comment">/**
<span id="line33" class="lineno">33</span>     * Serializes a value to JSON. The value is serialized by
<span id="line34" class="lineno">34</span>     * `JSON.stringify`, but unicode escape sequences are inserted
<span id="line35" class="lineno">35</span>     * for any non-printable ASCII characters.
<span id="line36" class="lineno">36</span>     *
<span id="line37" class="lineno">37</span>     * <span class="hljs-doctag">@param</span> {<span class="hljs-type">Object</span>} val the value to serialize
<span id="line38" class="lineno">38</span>     * <span class="hljs-doctag">@return</span> {<span class="hljs-type">string</span>} the JSON string
<span id="line39" class="lineno">39</span>     * <span class="hljs-doctag">@memberof</span> RapidContext.Encode
<span id="line40" class="lineno">40</span>     */</span>
<span id="line41" class="lineno">41</span>    <span class="hljs-keyword">function</span> <span class="hljs-title function_">toJSON</span>(<span class="hljs-params">val</span>) {
<span id="line42" class="lineno">42</span>        val = (val == <span class="hljs-literal">null</span>) ? <span class="hljs-literal">null</span> : val;
<span id="line43" class="lineno">43</span>        <span class="hljs-keyword">return</span> <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(val).<span class="hljs-title function_">replace</span>(<span class="hljs-regexp">/[\u007F-\uFFFF]/g</span>, toCharEscape);
<span id="line44" class="lineno">44</span>    }
<span id="line45" class="lineno">45</span>
<span id="line46" class="lineno">46</span>    <span class="hljs-comment">/**
<span id="line47" class="lineno">47</span>     * Serializes a value to a URL component. The value is serialized
<span id="line48" class="lineno">48</span>     * by `encodeURIComponent`, but any non-String values are first
<span id="line49" class="lineno">49</span>     * converted to strings.
<span id="line50" class="lineno">50</span>     *
<span id="line51" class="lineno">51</span>     * <span class="hljs-doctag">@param</span> {<span class="hljs-type">Object</span>} val the value to serialize
<span id="line52" class="lineno">52</span>     * <span class="hljs-doctag">@param</span> {<span class="hljs-type">Object</span>} isForm the flag for using `+` instead of `%20`
<span id="line53" class="lineno">53</span>     * <span class="hljs-doctag">@return</span> {<span class="hljs-type">string</span>} the URL-encoded string
<span id="line54" class="lineno">54</span>     * <span class="hljs-doctag">@memberof</span> RapidContext.Encode
<span id="line55" class="lineno">55</span>     */</span>
<span id="line56" class="lineno">56</span>    <span class="hljs-keyword">function</span> <span class="hljs-title function_">toUrlPart</span>(<span class="hljs-params">val, isForm</span>) {
<span id="line57" class="lineno">57</span>        val = (val == <span class="hljs-literal">null</span>) ? <span class="hljs-string">&quot;&quot;</span> : val;
<span id="line58" class="lineno">58</span>        <span class="hljs-keyword">var</span> isObject = <span class="hljs-title function_">typeof</span>(val) === <span class="hljs-string">&quot;object&quot;</span>;
<span id="line59" class="lineno">59</span>        <span class="hljs-keyword">var</span> res = <span class="hljs-built_in">encodeURIComponent</span>(isObject ? <span class="hljs-title function_">toJSON</span>(val) : <span class="hljs-title class_">String</span>(val));
<span id="line60" class="lineno">60</span>        <span class="hljs-keyword">return</span> isForm ? res.<span class="hljs-title function_">replace</span>(<span class="hljs-regexp">/%20/g</span>, <span class="hljs-string">&quot;+&quot;</span>) : res;
<span id="line61" class="lineno">61</span>    }
<span id="line62" class="lineno">62</span>
<span id="line63" class="lineno">63</span>    <span class="hljs-comment">/**
<span id="line64" class="lineno">64</span>     * Serializes an object to a URL query string. If an object value
<span id="line65" class="lineno">65</span>     * is an array, each entry will be added to the query separately.
<span id="line66" class="lineno">66</span>     *
<span id="line67" class="lineno">67</span>     * <span class="hljs-doctag">@param</span> {<span class="hljs-type">Object</span>} val the key-value pairs to serialize
<span id="line68" class="lineno">68</span>     * <span class="hljs-doctag">@param</span> {<span class="hljs-type">Object</span>} isForm the flag for using `+` instead of `%20`
<span id="line69" class="lineno">69</span>     * <span class="hljs-doctag">@return</span> {<span class="hljs-type">string</span>} the URL-encoded query string
<span id="line70" class="lineno">70</span>     * <span class="hljs-doctag">@memberof</span> RapidContext.Encode
<span id="line71" class="lineno">71</span>     */</span>
<span id="line72" class="lineno">72</span>    <span class="hljs-keyword">function</span> <span class="hljs-title function_">toUrlQuery</span>(<span class="hljs-params">data, isForm</span>) {
<span id="line73" class="lineno">73</span>        data = data || {};
<span id="line74" class="lineno">74</span>        <span class="hljs-keyword">var</span> parts = [];
<span id="line75" class="lineno">75</span>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> key <span class="hljs-keyword">in</span> data) {
<span id="line76" class="lineno">76</span>            <span class="hljs-keyword">var</span> val = data[key];
<span id="line77" class="lineno">77</span>            <span class="hljs-keyword">var</span> arr = <span class="hljs-title class_">Array</span>.<span class="hljs-title function_">isArray</span>(val) ? val : [val];
<span id="line78" class="lineno">78</span>            arr.<span class="hljs-property">length</span> || arr.<span class="hljs-title function_">push</span>(<span class="hljs-string">&quot;&quot;</span>);
<span id="line79" class="lineno">79</span>            arr.<span class="hljs-title function_">forEach</span>(<span class="hljs-keyword">function</span> (<span class="hljs-params">v</span>) {
<span id="line80" class="lineno">80</span>                parts.<span class="hljs-title function_">push</span>(<span class="hljs-title function_">toUrlPart</span>(key, isForm) + <span class="hljs-string">&quot;=&quot;</span> + <span class="hljs-title function_">toUrlPart</span>(v, isForm));
<span id="line81" class="lineno">81</span>            });
<span id="line82" class="lineno">82</span>        }
<span id="line83" class="lineno">83</span>        <span class="hljs-keyword">return</span> parts.<span class="hljs-title function_">join</span>(<span class="hljs-string">&quot;&amp;&quot;</span>);
<span id="line84" class="lineno">84</span>    }
<span id="line85" class="lineno">85</span>
<span id="line86" class="lineno">86</span>    <span class="hljs-comment">// Create namespaces &amp; export symbols</span>
<span id="line87" class="lineno">87</span>    <span class="hljs-keyword">var</span> <span class="hljs-title class_">RapidContext</span> = <span class="hljs-variable language_">window</span>.<span class="hljs-property">RapidContext</span> || (<span class="hljs-variable language_">window</span>.<span class="hljs-property">RapidContext</span> = {});
<span id="line88" class="lineno">88</span>    <span class="hljs-keyword">var</span> <span class="hljs-title class_">Encode</span> = <span class="hljs-title class_">RapidContext</span>.<span class="hljs-property">Encode</span> || (<span class="hljs-title class_">RapidContext</span>.<span class="hljs-property">Encode</span> = {});
<span id="line89" class="lineno">89</span>    <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">assign</span>(<span class="hljs-title class_">Encode</span>, { toJSON, toUrlPart, toUrlQuery });
<span id="line90" class="lineno">90</span>
<span id="line91" class="lineno">91</span>})(<span class="hljs-variable language_">this</span>);
<span id="line92" class="lineno">92</span></code></pre>
        </article>
    </section>





      </div>
    </section>

    <section class="footer center fineprint">
      <hr>
      Copyright &copy; 2007-2023 Per Cederberg. All rights reserved.
    </section>

  </body>
</html>
