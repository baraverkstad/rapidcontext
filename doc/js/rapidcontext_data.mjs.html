
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="JsDoc" />
    <link rel="stylesheet" href="../css/style.css" type="text/css">
    <link rel="stylesheet" href="../css/doc.css" type="text/css">
    <link rel="stylesheet" href="../css/font-awesome-4.7.0.min.css" type="text/css">
    <link rel="shortcut icon" type="image/vnd.microsoft.icon" href="../images/logotype-icon.ico">
    <link rel="icon" type="image/png" sizes="256x256" href="../images/logotype-icon-256x256.png">
    <link rel="apple-touch-icon" sizes="256x256" href="../images/logotype-icon-256x256.png">
    <title>RapidContext :: JavaScript API</title>
  </head>
  <body class="doc">

    <section class="header">
      <div class="center">
        <a href="https://www.rapidcontext.com/" class="logotype">
          <img src="../images/logotype.png" />
        </a>
        <div class="text">
          <a href="https://www.rapidcontext.com/">
            <span style="font-size: 3.6em;">RapidContext</span><br>
            <span style="font-size: 1.75em; color: #caf3ff;">Access &#183; Discovery &#183; Insight</span><br>
            <span style="font-size: 1.3em; letter-spacing: 0.34em; line-height: 1.8em;">www.rapidcontext.com</span>
          </a>
        </div>
      </div>
      <div class="menu">
        <a href="https://www.rapidcontext.com/doc/index.html">Docs</a>
        &bull; <a href="https://github.com/cederberg/rapidcontext/releases">Downloads</a>
        &bull; <a href="https://github.com/cederberg/rapidcontext">Project</a>
      </div>
    </section>

    <section class="content center">
      <ol class="breadcrumb">
        <li><a href="../index.html">Documentation</a></li>

        <li><a href="index.html">JavaScript API</a></li>
        <li class="active">rapidcontext/data.mjs</li>

      </ol>

      <div class="jsdoc">
        <h1 class="classTitle">Source rapidcontext/data.mjs</h1>




    <section>
        <article>
            <pre><code class="hljs language-js"><span id="line1" class="lineno">1</span><span class="hljs-comment">/*
<span id="line2" class="lineno">2</span> * RapidContext &lt;https://www.rapidcontext.com/&gt;
<span id="line3" class="lineno">3</span> * Copyright (c) 2007-2023 Per Cederberg. All rights reserved.
<span id="line4" class="lineno">4</span> *
<span id="line5" class="lineno">5</span> * This program is free software: you can redistribute it and/or
<span id="line6" class="lineno">6</span> * modify it under the terms of the BSD license.
<span id="line7" class="lineno">7</span> *
<span id="line8" class="lineno">8</span> * This program is distributed in the hope that it will be useful,
<span id="line9" class="lineno">9</span> * but WITHOUT ANY WARRANTY; without even the implied warranty of
<span id="line10" class="lineno">10</span> * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.
<span id="line11" class="lineno">11</span> *
<span id="line12" class="lineno">12</span> * See the RapidContext LICENSE for more details.
<span id="line13" class="lineno">13</span> */</span>
<span id="line14" class="lineno">14</span>
<span id="line15" class="lineno">15</span><span class="hljs-comment">/**
<span id="line16" class="lineno">16</span> * Provides functions for data conversion, filtering, mapping, etc.
<span id="line17" class="lineno">17</span> * <span class="hljs-doctag">@namespace</span> RapidContext.Data
<span id="line18" class="lineno">18</span> */</span>
<span id="line19" class="lineno">19</span>
<span id="line20" class="lineno">20</span><span class="hljs-keyword">import</span> { isNil, isFunction, isObject, isArrayLike, isIterable, hasProperty, hasValue } <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;./fn.mjs&#x27;</span>;
<span id="line21" class="lineno">21</span>
<span id="line22" class="lineno">22</span><span class="hljs-keyword">const</span> <span class="hljs-variable constant_">OFF</span> = [<span class="hljs-string">&#x27;null&#x27;</span>, <span class="hljs-string">&#x27;undefined&#x27;</span>, <span class="hljs-string">&#x27;0&#x27;</span>, <span class="hljs-string">&#x27;f&#x27;</span>, <span class="hljs-string">&#x27;false&#x27;</span>, <span class="hljs-string">&#x27;off&#x27;</span>, <span class="hljs-string">&#x27;n&#x27;</span>, <span class="hljs-string">&#x27;no&#x27;</span>];
<span id="line23" class="lineno">23</span>
<span id="line24" class="lineno">24</span><span class="hljs-comment">/**
<span id="line25" class="lineno">25</span> * Converts a value to a boolean. This is identical to `!!val`, but also
<span id="line26" class="lineno">26</span> * converts `&quot;null&quot;`, `&quot;0&quot;`, `&quot;false&quot;`, `&quot;off&quot;` and similar values to `false`.
<span id="line27" class="lineno">27</span> *
<span id="line28" class="lineno">28</span> * <span class="hljs-doctag">@param</span> {<span class="hljs-type">*</span>} val the value to convert
<span id="line29" class="lineno">29</span> * <span class="hljs-doctag">@return</span> {<span class="hljs-type">boolean</span>} `true` or `false` depending on the value
<span id="line30" class="lineno">30</span> * <span class="hljs-doctag">@name</span> <span class="hljs-variable">bool</span>
<span id="line31" class="lineno">31</span> * <span class="hljs-doctag">@memberof</span> RapidContext.Data
<span id="line32" class="lineno">32</span> *
<span id="line33" class="lineno">33</span> * <span class="hljs-doctag">@example</span>
<span id="line34" class="lineno">34</span> * bool(undefined) //==&gt; false
<span id="line35" class="lineno">35</span> * bool(&#x27;&#x27;) //==&gt; false
<span id="line36" class="lineno">36</span> * bool(&#x27;FaLsE&#x27;) //==&gt; false
<span id="line37" class="lineno">37</span> */</span>
<span id="line38" class="lineno">38</span><span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">bool</span>(<span class="hljs-params">val</span>) {
<span id="line39" class="lineno">39</span>    <span class="hljs-keyword">return</span> !!val &amp;&amp; !<span class="hljs-variable constant_">OFF</span>.<span class="hljs-title function_">includes</span>(<span class="hljs-title class_">String</span>(val).<span class="hljs-title function_">toLowerCase</span>());
<span id="line40" class="lineno">40</span>}
<span id="line41" class="lineno">41</span>
<span id="line42" class="lineno">42</span><span class="hljs-comment">/**
<span id="line43" class="lineno">43</span> * Creates a new array from a collection of elements. This is similar to
<span id="line44" class="lineno">44</span> * `Array.from()`, but also supports iterating over object properties (using
<span id="line45" class="lineno">45</span> * `Object.values()`). When more than a single argument is provided, this
<span id="line46" class="lineno">46</span> * function is similar to `Array.of()`.
<span id="line47" class="lineno">47</span> *
<span id="line48" class="lineno">48</span> * <span class="hljs-doctag">@param</span> {<span class="hljs-type">Object|Iterable|...*</span>} coll the elements to include
<span id="line49" class="lineno">49</span> * <span class="hljs-doctag">@return</span> {<span class="hljs-type">Array</span>} a new `Array` with all the collection elements
<span id="line50" class="lineno">50</span> * <span class="hljs-doctag">@name</span> <span class="hljs-variable">array</span>
<span id="line51" class="lineno">51</span> * <span class="hljs-doctag">@memberof</span> RapidContext.Data
<span id="line52" class="lineno">52</span> *
<span id="line53" class="lineno">53</span> * <span class="hljs-doctag">@example</span>
<span id="line54" class="lineno">54</span> * array(null) //==&gt; []
<span id="line55" class="lineno">55</span> * array({ a: 1, b: 2, c: 3 }) //==&gt; [1, 2, 3]
<span id="line56" class="lineno">56</span> * array(1, 2, 3) //==&gt; [1, 2, 3]
<span id="line57" class="lineno">57</span> */</span>
<span id="line58" class="lineno">58</span><span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">array</span>(<span class="hljs-params">coll</span>) {
<span id="line59" class="lineno">59</span>    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">arguments</span>.<span class="hljs-property">length</span> === <span class="hljs-number">1</span> &amp;&amp; <span class="hljs-title function_">isNil</span>(coll)) {
<span id="line60" class="lineno">60</span>        <span class="hljs-keyword">return</span> [];
<span id="line61" class="lineno">61</span>    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">arguments</span>.<span class="hljs-property">length</span> === <span class="hljs-number">1</span> &amp;&amp; <span class="hljs-title function_">isObject</span>(coll)) {
<span id="line62" class="lineno">62</span>        <span class="hljs-keyword">return</span> <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">values</span>(coll);
<span id="line63" class="lineno">63</span>    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">arguments</span>.<span class="hljs-property">length</span> === <span class="hljs-number">1</span> &amp;&amp; (<span class="hljs-title function_">isArrayLike</span>(coll) || <span class="hljs-title function_">isIterable</span>(coll))) {
<span id="line64" class="lineno">64</span>        <span class="hljs-keyword">return</span> <span class="hljs-title class_">Array</span>.<span class="hljs-title function_">from</span>(coll);
<span id="line65" class="lineno">65</span>    } <span class="hljs-keyword">else</span> {
<span id="line66" class="lineno">66</span>        <span class="hljs-keyword">return</span> <span class="hljs-title class_">Array</span>.<span class="hljs-title function_">from</span>(<span class="hljs-variable language_">arguments</span>);
<span id="line67" class="lineno">67</span>    }
<span id="line68" class="lineno">68</span>}
<span id="line69" class="lineno">69</span>
<span id="line70" class="lineno">70</span><span class="hljs-comment">/**
<span id="line71" class="lineno">71</span> * Creates a new object from a collection of properties. The properties can be
<span id="line72" class="lineno">72</span> * specified in a number of ways, either as two separate arrays of keys and
<span id="line73" class="lineno">73</span> * values, as a single array of key-value pairs, as a object with properties to
<span id="line74" class="lineno">74</span> * copy, or as a lookup function (or query path). The values can be specified
<span id="line75" class="lineno">75</span> * as an array, a lookup object, a generator function, or a constant value.
<span id="line76" class="lineno">76</span> *
<span id="line77" class="lineno">77</span> * <span class="hljs-doctag">@param</span> {<span class="hljs-type">Array|Object|function|string</span>} keys the object keys or key-pairs
<span id="line78" class="lineno">78</span> * <span class="hljs-doctag">@param</span> {<span class="hljs-type">Array|Object|function|*</span>} [values] the values or generator function
<span id="line79" class="lineno">79</span> * <span class="hljs-doctag">@return</span> {<span class="hljs-type">Object</span>} a new `Object` with the specified properties
<span id="line80" class="lineno">80</span> * <span class="hljs-doctag">@name</span> <span class="hljs-variable">object</span>
<span id="line81" class="lineno">81</span> * <span class="hljs-doctag">@memberof</span> RapidContext.Data
<span id="line82" class="lineno">82</span> *
<span id="line83" class="lineno">83</span> * <span class="hljs-doctag">@example</span>
<span id="line84" class="lineno">84</span> * object([&#x27;a&#x27;, &#x27;b&#x27;], true) //==&gt; { a: true, b: true }
<span id="line85" class="lineno">85</span> * object([&#x27;a&#x27;, &#x27;b&#x27;], [1, 2]) //==&gt; { a: 1, b: 2 }
<span id="line86" class="lineno">86</span> * object([&#x27;a&#x27;, &#x27;b&#x27;], { a: 1, b: 2, c: 3, d: 4 }) //==&gt; { a: 1, b: 2 }
<span id="line87" class="lineno">87</span> * object({ a: 1, b: 2 }, true) //==&gt; { a: true, b: true }
<span id="line88" class="lineno">88</span> * object(&#x27;id&#x27;, [{ id: &#x27;a&#x27;, val: 1 }, ...]) //==&gt; { a: { id: &#x27;a&#x27;, val: 1 }, ... }
<span id="line89" class="lineno">89</span> */</span>
<span id="line90" class="lineno">90</span><span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">object</span>(<span class="hljs-params">keys, values</span>) {
<span id="line91" class="lineno">91</span>    <span class="hljs-keyword">function</span> <span class="hljs-title function_">keyPair</span>(<span class="hljs-params">key, idx</span>) {
<span id="line92" class="lineno">92</span>        <span class="hljs-keyword">if</span> (<span class="hljs-title class_">Array</span>.<span class="hljs-title function_">isArray</span>(values)) {
<span id="line93" class="lineno">93</span>            <span class="hljs-keyword">return</span> [key, values[idx]];
<span id="line94" class="lineno">94</span>        } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-title function_">isObject</span>(values)) {
<span id="line95" class="lineno">95</span>            <span class="hljs-keyword">return</span> [key, values[key]];
<span id="line96" class="lineno">96</span>        } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-title function_">isFunction</span>(values)) {
<span id="line97" class="lineno">97</span>            <span class="hljs-keyword">try</span> {
<span id="line98" class="lineno">98</span>                <span class="hljs-keyword">return</span> [key, <span class="hljs-title function_">values</span>(key)];
<span id="line99" class="lineno">99</span>            } <span class="hljs-keyword">catch</span> (ignore) {
<span id="line100" class="lineno">100</span>                <span class="hljs-keyword">return</span> [key];
<span id="line101" class="lineno">101</span>            }
<span id="line102" class="lineno">102</span>        } <span class="hljs-keyword">else</span> {
<span id="line103" class="lineno">103</span>            <span class="hljs-keyword">return</span> [key, values];
<span id="line104" class="lineno">104</span>        }
<span id="line105" class="lineno">105</span>    }
<span id="line106" class="lineno">106</span>    <span class="hljs-keyword">function</span> <span class="hljs-title function_">merge</span>(<span class="hljs-params">obj, value</span>) {
<span id="line107" class="lineno">107</span>        <span class="hljs-keyword">let</span> k = <span class="hljs-title class_">Array</span>.<span class="hljs-title function_">isArray</span>(value) ? value[<span class="hljs-number">0</span>] : value;
<span id="line108" class="lineno">108</span>        <span class="hljs-keyword">let</span> v = <span class="hljs-title class_">Array</span>.<span class="hljs-title function_">isArray</span>(value) ? value[<span class="hljs-number">1</span>] : <span class="hljs-literal">undefined</span>;
<span id="line109" class="lineno">109</span>        <span class="hljs-keyword">if</span> (<span class="hljs-title function_">hasValue</span>(k) &amp;&amp; !(k <span class="hljs-keyword">in</span> obj)) {
<span id="line110" class="lineno">110</span>            obj[k] = v;
<span id="line111" class="lineno">111</span>        }
<span id="line112" class="lineno">112</span>        <span class="hljs-keyword">return</span> obj;
<span id="line113" class="lineno">113</span>    }
<span id="line114" class="lineno">114</span>    <span class="hljs-keyword">if</span> (<span class="hljs-title class_">Array</span>.<span class="hljs-title function_">isArray</span>(keys)) {
<span id="line115" class="lineno">115</span>        <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">arguments</span>.<span class="hljs-property">length</span> &lt; <span class="hljs-number">2</span>) {
<span id="line116" class="lineno">116</span>            <span class="hljs-keyword">return</span> keys.<span class="hljs-title function_">reduce</span>(merge, {});
<span id="line117" class="lineno">117</span>        } <span class="hljs-keyword">else</span> {
<span id="line118" class="lineno">118</span>            <span class="hljs-keyword">return</span> keys.<span class="hljs-title function_">map</span>(keyPair).<span class="hljs-title function_">reduce</span>(merge, {});
<span id="line119" class="lineno">119</span>        }
<span id="line120" class="lineno">120</span>    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-title function_">isObject</span>(keys)) {
<span id="line121" class="lineno">121</span>        <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">arguments</span>.<span class="hljs-property">length</span> &lt; <span class="hljs-number">2</span>) {
<span id="line122" class="lineno">122</span>            <span class="hljs-keyword">return</span> <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">assign</span>({}, keys);
<span id="line123" class="lineno">123</span>        } <span class="hljs-keyword">else</span> {
<span id="line124" class="lineno">124</span>            <span class="hljs-keyword">return</span> <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">keys</span>(keys).<span class="hljs-title function_">map</span>(keyPair).<span class="hljs-title function_">reduce</span>(merge, {});
<span id="line125" class="lineno">125</span>        }
<span id="line126" class="lineno">126</span>    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (keys) {
<span id="line127" class="lineno">127</span>        keys = <span class="hljs-title function_">map</span>(keys, values);
<span id="line128" class="lineno">128</span>        <span class="hljs-keyword">return</span> keys.<span class="hljs-title function_">map</span>(keyPair).<span class="hljs-title function_">reduce</span>(merge, {});
<span id="line129" class="lineno">129</span>    } <span class="hljs-keyword">else</span> {
<span id="line130" class="lineno">130</span>        <span class="hljs-keyword">return</span> {};
<span id="line131" class="lineno">131</span>    }
<span id="line132" class="lineno">132</span>}
<span id="line133" class="lineno">133</span>
<span id="line134" class="lineno">134</span><span class="hljs-comment">/**
<span id="line135" class="lineno">135</span> * Creates a deep copy of an `Array` or an `Object`. Nested values will be
<span id="line136" class="lineno">136</span> * copied recursively. Only plain objects are be copied, others (including
<span id="line137" class="lineno">137</span> * primitive values) are returned as-is.
<span id="line138" class="lineno">138</span> *
<span id="line139" class="lineno">139</span> * <span class="hljs-doctag">@param</span> {<span class="hljs-type">Array|Object|*</span>} value the object or array to copy
<span id="line140" class="lineno">140</span> * <span class="hljs-doctag">@return</span> {<span class="hljs-type">Array|Object|*</span>} a new `Array` or `Object` with the same content
<span id="line141" class="lineno">141</span> * <span class="hljs-doctag">@name</span> <span class="hljs-variable">clone</span>
<span id="line142" class="lineno">142</span> * <span class="hljs-doctag">@memberof</span> RapidContext.Data
<span id="line143" class="lineno">143</span> */</span>
<span id="line144" class="lineno">144</span><span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">clone</span>(<span class="hljs-params">value</span>) {
<span id="line145" class="lineno">145</span>    <span class="hljs-keyword">if</span> (<span class="hljs-title class_">Array</span>.<span class="hljs-title function_">isArray</span>(value) || <span class="hljs-title function_">isObject</span>(value)) {
<span id="line146" class="lineno">146</span>        <span class="hljs-keyword">return</span> <span class="hljs-title function_">map</span>(clone, value);
<span id="line147" class="lineno">147</span>    } <span class="hljs-keyword">else</span> {
<span id="line148" class="lineno">148</span>        <span class="hljs-keyword">return</span> value;
<span id="line149" class="lineno">149</span>    }
<span id="line150" class="lineno">150</span>}
<span id="line151" class="lineno">151</span>
<span id="line152" class="lineno">152</span><span class="hljs-comment">/**
<span id="line153" class="lineno">153</span> * Retrieves one or more values from a data structure. The `key` provides a
<span id="line154" class="lineno">154</span> * dot-separated query path to traverse the data structure to any depth.
<span id="line155" class="lineno">155</span> * Wildcard property names are specified as `*`. Wildcard array elements are
<span id="line156" class="lineno">156</span> * specified as `[]`. The path may also be provided as an Array if needed.
<span id="line157" class="lineno">157</span> * Returns a bound function if only a single argument is specified.
<span id="line158" class="lineno">158</span> *
<span id="line159" class="lineno">159</span> * <span class="hljs-doctag">@param</span> {<span class="hljs-type">string|Array</span>} key the value query path
<span id="line160" class="lineno">160</span> * <span class="hljs-doctag">@param</span> {<span class="hljs-type">object|Array</span>} [val] the data structure to traverse
<span id="line161" class="lineno">161</span> * <span class="hljs-doctag">@return</span> {<span class="hljs-type">number|function</span>} the value found, or a bound function
<span id="line162" class="lineno">162</span> * <span class="hljs-doctag">@name</span> <span class="hljs-variable">get</span>
<span id="line163" class="lineno">163</span> * <span class="hljs-doctag">@memberof</span> RapidContext.Data
<span id="line164" class="lineno">164</span> *
<span id="line165" class="lineno">165</span> * <span class="hljs-doctag">@example</span>
<span id="line166" class="lineno">166</span> * get(&#x27;a.b&#x27;, { a: { b: 42 } }) //==&gt; 42
<span id="line167" class="lineno">167</span> * get(&#x27;*.b&#x27;, { a: { b: 42 }, c: { b: 13 } }) //==&gt; [42, 13]
<span id="line168" class="lineno">168</span> * get(&#x27;a.*&#x27;, { a: { b: 42 }, c: { b: 13 } }) //==&gt; [42]
<span id="line169" class="lineno">169</span> * get(&#x27;[].b&#x27;, [ { a: 42 }, { b: 13 }, { b: 1} }) //==&gt; [13, 1]
<span id="line170" class="lineno">170</span> * get(&#x27;1.b&#x27;, [ { a: 42 }, { b: 13 }, { b: 1} }) //==&gt; 13
<span id="line171" class="lineno">171</span> */</span>
<span id="line172" class="lineno">172</span><span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">get</span>(<span class="hljs-params">key, val</span>) {
<span id="line173" class="lineno">173</span>    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">arguments</span>.<span class="hljs-property">length</span> &lt; <span class="hljs-number">2</span>) {
<span id="line174" class="lineno">174</span>        <span class="hljs-keyword">return</span> get.<span class="hljs-title function_">bind</span>(<span class="hljs-literal">null</span>, ...<span class="hljs-variable language_">arguments</span>);
<span id="line175" class="lineno">175</span>    } <span class="hljs-keyword">else</span> {
<span id="line176" class="lineno">176</span>        <span class="hljs-keyword">let</span> path = <span class="hljs-title class_">Array</span>.<span class="hljs-title function_">isArray</span>(key) ? [].<span class="hljs-title function_">concat</span>(key) : (<span class="hljs-string">&#x27;&#x27;</span> + key).<span class="hljs-title function_">split</span>(<span class="hljs-regexp">/(?=\[)|\./</span>);
<span id="line177" class="lineno">177</span>        <span class="hljs-keyword">let</span> hasWildcard = path.<span class="hljs-title function_">some</span>(<span class="hljs-function">(<span class="hljs-params">el</span>) =&gt;</span> el === <span class="hljs-string">&#x27;*&#x27;</span> || el === <span class="hljs-string">&#x27;[]&#x27;</span>);
<span id="line178" class="lineno">178</span>        <span class="hljs-keyword">let</span> ctx = [val];
<span id="line179" class="lineno">179</span>        <span class="hljs-keyword">while</span> (path.<span class="hljs-property">length</span> &gt; <span class="hljs-number">0</span> &amp;&amp; ctx.<span class="hljs-property">length</span> &gt; <span class="hljs-number">0</span>) {
<span id="line180" class="lineno">180</span>            ctx = ctx.<span class="hljs-title function_">filter</span>(<span class="hljs-function">(<span class="hljs-params">o</span>) =&gt;</span> !<span class="hljs-title function_">isNil</span>(o));
<span id="line181" class="lineno">181</span>            <span class="hljs-keyword">let</span> el = path.<span class="hljs-title function_">shift</span>();
<span id="line182" class="lineno">182</span>            <span class="hljs-keyword">if</span> (el === <span class="hljs-string">&#x27;*&#x27;</span> || el === <span class="hljs-string">&#x27;[]&#x27;</span>) {
<span id="line183" class="lineno">183</span>                <span class="hljs-keyword">let</span> arrs = (el === <span class="hljs-string">&#x27;*&#x27;</span>) ? ctx.<span class="hljs-title function_">map</span>(<span class="hljs-title class_">Object</span>.<span class="hljs-property">values</span>) : ctx.<span class="hljs-title function_">filter</span>(<span class="hljs-title class_">Array</span>.<span class="hljs-property">isArray</span>);
<span id="line184" class="lineno">184</span>                ctx = <span class="hljs-title class_">Array</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">concat</span>.<span class="hljs-title function_">apply</span>([], arrs); <span class="hljs-comment">// <span class="hljs-doctag">FIXME:</span> arrs.flat()</span>
<span id="line185" class="lineno">185</span>            } <span class="hljs-keyword">else</span> {
<span id="line186" class="lineno">186</span>                <span class="hljs-keyword">let</span> k = <span class="hljs-regexp">/^\[\d+\]$/</span>.<span class="hljs-title function_">test</span>(el) ? <span class="hljs-built_in">parseInt</span>(el.<span class="hljs-title function_">substr</span>(<span class="hljs-number">1</span>), <span class="hljs-number">10</span>) : el;
<span id="line187" class="lineno">187</span>                ctx = ctx.<span class="hljs-title function_">filter</span>(<span class="hljs-title function_">hasProperty</span>(k)).<span class="hljs-title function_">map</span>(<span class="hljs-function">(<span class="hljs-params">o</span>) =&gt;</span> o[k]);
<span id="line188" class="lineno">188</span>            }
<span id="line189" class="lineno">189</span>        }
<span id="line190" class="lineno">190</span>        <span class="hljs-keyword">return</span> (ctx.<span class="hljs-property">length</span> &gt; <span class="hljs-number">1</span> || hasWildcard) ? ctx : ctx[<span class="hljs-number">0</span>];
<span id="line191" class="lineno">191</span>    }
<span id="line192" class="lineno">192</span>}
<span id="line193" class="lineno">193</span>
<span id="line194" class="lineno">194</span><span class="hljs-comment">/**
<span id="line195" class="lineno">195</span> * Filters a collection based on a predicate function. The input collection can
<span id="line196" class="lineno">196</span> * be either an Array-like object, or a plain object. The predicate function
<span id="line197" class="lineno">197</span> * `fn(val, idx/key, arr/obj)` is called for each array item or object
<span id="line198" class="lineno">198</span> * property. As an alternative to a function, a string query path can be
<span id="line199" class="lineno">199</span> * specified instead. Returns a new `Array` or `Object` depending on the input
<span id="line200" class="lineno">200</span> * collection. Returns a bound function if only a single argument is specified.
<span id="line201" class="lineno">201</span> *
<span id="line202" class="lineno">202</span> * <span class="hljs-doctag">@param</span> {<span class="hljs-type">function|string</span>} fn the predicate function or query path
<span id="line203" class="lineno">203</span> * <span class="hljs-doctag">@param</span> {<span class="hljs-type">object|Array</span>} [coll] the collection to filter
<span id="line204" class="lineno">204</span> * <span class="hljs-doctag">@return</span> {<span class="hljs-type">object|Array|function</span>} the new collection, or a bound function
<span id="line205" class="lineno">205</span> * <span class="hljs-doctag">@name</span> <span class="hljs-variable">filter</span>
<span id="line206" class="lineno">206</span> * <span class="hljs-doctag">@memberof</span> RapidContext.Data
<span id="line207" class="lineno">207</span> *
<span id="line208" class="lineno">208</span> * <span class="hljs-doctag">@example</span>
<span id="line209" class="lineno">209</span> * filter(Boolean, [null, undefined, true, 0, &#x27;&#x27;]) //==&gt; [true]
<span id="line210" class="lineno">210</span> * filter(Boolean, { a: null, b: true, c: 0, d: 1 }) //==&gt; { b: true, d: 1 }
<span id="line211" class="lineno">211</span> * filter(&#x27;id&#x27;, [null, { id: 3 }, {}, { id: false }]) //==&gt; [3]
<span id="line212" class="lineno">212</span> */</span>
<span id="line213" class="lineno">213</span><span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">filter</span>(<span class="hljs-params">fn, coll</span>) {
<span id="line214" class="lineno">214</span>    <span class="hljs-keyword">function</span> <span class="hljs-title function_">test</span>(<span class="hljs-params">v, k, o</span>) {
<span id="line215" class="lineno">215</span>        <span class="hljs-keyword">try</span> {
<span id="line216" class="lineno">216</span>            <span class="hljs-keyword">return</span> <span class="hljs-title function_">fn</span>(v, k, o);
<span id="line217" class="lineno">217</span>        } <span class="hljs-keyword">catch</span> (e) {
<span id="line218" class="lineno">218</span>            <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
<span id="line219" class="lineno">219</span>        }
<span id="line220" class="lineno">220</span>    }
<span id="line221" class="lineno">221</span>    fn = <span class="hljs-title function_">isFunction</span>(fn) ? fn : <span class="hljs-title function_">get</span>(fn);
<span id="line222" class="lineno">222</span>    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">arguments</span>.<span class="hljs-property">length</span> &lt; <span class="hljs-number">2</span>) {
<span id="line223" class="lineno">223</span>        <span class="hljs-keyword">return</span> filter.<span class="hljs-title function_">bind</span>(<span class="hljs-literal">null</span>, ...<span class="hljs-variable language_">arguments</span>);
<span id="line224" class="lineno">224</span>    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-title class_">Array</span>.<span class="hljs-title function_">isArray</span>(coll)) {
<span id="line225" class="lineno">225</span>        <span class="hljs-keyword">return</span> coll.<span class="hljs-title function_">filter</span>(test);
<span id="line226" class="lineno">226</span>    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-title function_">isObject</span>(coll)) {
<span id="line227" class="lineno">227</span>        <span class="hljs-keyword">let</span> obj = {};
<span id="line228" class="lineno">228</span>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> k <span class="hljs-keyword">in</span> coll) {
<span id="line229" class="lineno">229</span>            <span class="hljs-keyword">let</span> v = coll[k];
<span id="line230" class="lineno">230</span>            <span class="hljs-keyword">if</span> (<span class="hljs-title function_">hasProperty</span>(k, coll) &amp;&amp; <span class="hljs-title function_">test</span>(v, k, coll)) {
<span id="line231" class="lineno">231</span>                obj[k] = v;
<span id="line232" class="lineno">232</span>            }
<span id="line233" class="lineno">233</span>        }
<span id="line234" class="lineno">234</span>        <span class="hljs-keyword">return</span> obj;
<span id="line235" class="lineno">235</span>    } <span class="hljs-keyword">else</span> {
<span id="line236" class="lineno">236</span>        <span class="hljs-keyword">let</span> arr = [];
<span id="line237" class="lineno">237</span>        <span class="hljs-keyword">let</span> len = +(coll &amp;&amp; coll.<span class="hljs-property">length</span>) || <span class="hljs-number">0</span>;
<span id="line238" class="lineno">238</span>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; len; i++) {
<span id="line239" class="lineno">239</span>            <span class="hljs-keyword">let</span> v = coll[i];
<span id="line240" class="lineno">240</span>            <span class="hljs-keyword">if</span> (<span class="hljs-title function_">test</span>(v, i, coll)) {
<span id="line241" class="lineno">241</span>                arr.<span class="hljs-title function_">push</span>(v);
<span id="line242" class="lineno">242</span>            }
<span id="line243" class="lineno">243</span>        }
<span id="line244" class="lineno">244</span>        <span class="hljs-keyword">return</span> arr;
<span id="line245" class="lineno">245</span>    }
<span id="line246" class="lineno">246</span>}
<span id="line247" class="lineno">247</span>
<span id="line248" class="lineno">248</span><span class="hljs-comment">/**
<span id="line249" class="lineno">249</span> * Concatenates nested `Array` elements into a parent `Array`. As an
<span id="line250" class="lineno">250</span> * alternative, the array elements may be specified as arguments. Only the
<span id="line251" class="lineno">251</span> * first level of `Array` elements are flattened by this method. In modern
<span id="line252" class="lineno">252</span> * environments, consider using `Array.prototype.flat()` instead.
<span id="line253" class="lineno">253</span> *
<span id="line254" class="lineno">254</span> * <span class="hljs-doctag">@param</span> {<span class="hljs-type">Array|...*</span>} arr the input array or sequence of elements
<span id="line255" class="lineno">255</span> * <span class="hljs-doctag">@return</span> {<span class="hljs-type">Array</span>} the new flattened `Array`
<span id="line256" class="lineno">256</span> * <span class="hljs-doctag">@name</span> <span class="hljs-variable">flatten</span>
<span id="line257" class="lineno">257</span> * <span class="hljs-doctag">@memberof</span> RapidContext.Data
<span id="line258" class="lineno">258</span> */</span>
<span id="line259" class="lineno">259</span><span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">flatten</span>(<span class="hljs-params">arr</span>) {
<span id="line260" class="lineno">260</span>    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">arguments</span>.<span class="hljs-property">length</span> === <span class="hljs-number">1</span> &amp;&amp; <span class="hljs-title class_">Array</span>.<span class="hljs-title function_">isArray</span>(arr)) {
<span id="line261" class="lineno">261</span>        <span class="hljs-keyword">return</span> <span class="hljs-title class_">Array</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">concat</span>.<span class="hljs-title function_">apply</span>([], arr);
<span id="line262" class="lineno">262</span>    } <span class="hljs-keyword">else</span> {
<span id="line263" class="lineno">263</span>        <span class="hljs-keyword">return</span> <span class="hljs-title class_">Array</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">concat</span>.<span class="hljs-title function_">apply</span>([], <span class="hljs-variable language_">arguments</span>);
<span id="line264" class="lineno">264</span>    }
<span id="line265" class="lineno">265</span>}
<span id="line266" class="lineno">266</span>
<span id="line267" class="lineno">267</span><span class="hljs-comment">/**
<span id="line268" class="lineno">268</span> * Applies a function to each item or property in an input collection and
<span id="line269" class="lineno">269</span> * returns the results. The input collection can be either an Array-like
<span id="line270" class="lineno">270</span> * object, or a plain object. The mapping function `fn(val, idx/key, arr/obj)`
<span id="line271" class="lineno">271</span> * is called for each array item or object property. As an alternative to a
<span id="line272" class="lineno">272</span> * function, a string query path can be specified instead. Returns a new
<span id="line273" class="lineno">273</span> * `Array` or `Object` depending on the input collection. Returns a bound
<span id="line274" class="lineno">274</span> * function if only a single argument is specified.
<span id="line275" class="lineno">275</span> *
<span id="line276" class="lineno">276</span> * <span class="hljs-doctag">@param</span> {<span class="hljs-type">function|string</span>} fn the mapping function or query path
<span id="line277" class="lineno">277</span> * <span class="hljs-doctag">@param</span> {<span class="hljs-type">object|Array</span>} [coll] the collection to process
<span id="line278" class="lineno">278</span> * <span class="hljs-doctag">@return</span> {<span class="hljs-type">object|Array|function</span>} the new collection, or a bound function
<span id="line279" class="lineno">279</span> * <span class="hljs-doctag">@name</span> <span class="hljs-variable">map</span>
<span id="line280" class="lineno">280</span> * <span class="hljs-doctag">@memberof</span> RapidContext.Data
<span id="line281" class="lineno">281</span> *
<span id="line282" class="lineno">282</span> * <span class="hljs-doctag">@example</span>
<span id="line283" class="lineno">283</span> * map(Boolean, [null, true, 0, 1, &#x27;&#x27;]) //==&gt; [false, true, false, true, false]
<span id="line284" class="lineno">284</span> * map(Boolean, { a: null, b: true, c: 0 }) //==&gt; { a: false, b: true, c: false }
<span id="line285" class="lineno">285</span> * map(&#x27;id&#x27;, [{ id: 1 }, { id: 3 }) //==&gt; [1, 3]
<span id="line286" class="lineno">286</span> */</span>
<span id="line287" class="lineno">287</span><span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">map</span>(<span class="hljs-params">fn, coll</span>) {
<span id="line288" class="lineno">288</span>    <span class="hljs-keyword">function</span> <span class="hljs-title function_">inner</span>(<span class="hljs-params">v, k, o</span>) {
<span id="line289" class="lineno">289</span>        <span class="hljs-keyword">try</span> {
<span id="line290" class="lineno">290</span>            <span class="hljs-keyword">return</span> <span class="hljs-title function_">fn</span>(v, k, o);
<span id="line291" class="lineno">291</span>        } <span class="hljs-keyword">catch</span> (e) {
<span id="line292" class="lineno">292</span>            <span class="hljs-keyword">return</span> <span class="hljs-literal">undefined</span>;
<span id="line293" class="lineno">293</span>        }
<span id="line294" class="lineno">294</span>    }
<span id="line295" class="lineno">295</span>    fn = <span class="hljs-title function_">isFunction</span>(fn) ? fn : <span class="hljs-title function_">get</span>(fn);
<span id="line296" class="lineno">296</span>    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">arguments</span>.<span class="hljs-property">length</span> &lt; <span class="hljs-number">2</span>) {
<span id="line297" class="lineno">297</span>        <span class="hljs-keyword">return</span> map.<span class="hljs-title function_">bind</span>(<span class="hljs-literal">null</span>, ...<span class="hljs-variable language_">arguments</span>);
<span id="line298" class="lineno">298</span>    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-title class_">Array</span>.<span class="hljs-title function_">isArray</span>(coll)) {
<span id="line299" class="lineno">299</span>        <span class="hljs-keyword">return</span> coll.<span class="hljs-title function_">map</span>(inner);
<span id="line300" class="lineno">300</span>    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-title function_">isObject</span>(coll)) {
<span id="line301" class="lineno">301</span>        <span class="hljs-keyword">let</span> obj = {};
<span id="line302" class="lineno">302</span>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> k <span class="hljs-keyword">in</span> coll) {
<span id="line303" class="lineno">303</span>            <span class="hljs-keyword">let</span> v = coll[k];
<span id="line304" class="lineno">304</span>            <span class="hljs-keyword">if</span> (<span class="hljs-title function_">hasProperty</span>(k, coll)) {
<span id="line305" class="lineno">305</span>                obj[k] = <span class="hljs-title function_">inner</span>(v, k, coll);
<span id="line306" class="lineno">306</span>            }
<span id="line307" class="lineno">307</span>        }
<span id="line308" class="lineno">308</span>        <span class="hljs-keyword">return</span> obj;
<span id="line309" class="lineno">309</span>    } <span class="hljs-keyword">else</span> {
<span id="line310" class="lineno">310</span>        <span class="hljs-keyword">let</span> arr = [];
<span id="line311" class="lineno">311</span>        <span class="hljs-keyword">let</span> len = +(coll &amp;&amp; coll.<span class="hljs-property">length</span>) || <span class="hljs-number">0</span>;
<span id="line312" class="lineno">312</span>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; len; i++) {
<span id="line313" class="lineno">313</span>            <span class="hljs-keyword">let</span> v = coll[i];
<span id="line314" class="lineno">314</span>            arr.<span class="hljs-title function_">push</span>(<span class="hljs-title function_">inner</span>(v, i, coll));
<span id="line315" class="lineno">315</span>        }
<span id="line316" class="lineno">316</span>        <span class="hljs-keyword">return</span> arr;
<span id="line317" class="lineno">317</span>    }
<span id="line318" class="lineno">318</span>}
<span id="line319" class="lineno">319</span>
<span id="line320" class="lineno">320</span><span class="hljs-comment">/**
<span id="line321" class="lineno">321</span> * Returns the unique values of a collection. An optional function may be
<span id="line322" class="lineno">322</span> * provided to extract the key to compare with the other elements. If no
<span id="line323" class="lineno">323</span> * function is specified, `JSON.stringify` is used to determine uniqueness.
<span id="line324" class="lineno">324</span> * Returns a bound function if only a single function argument is specified.
<span id="line325" class="lineno">325</span> *
<span id="line326" class="lineno">326</span> * <span class="hljs-doctag">@param</span> {<span class="hljs-type">function</span>} [fn] the comparison key extract function
<span id="line327" class="lineno">327</span> * <span class="hljs-doctag">@param</span> {<span class="hljs-type">Array|Object|Iterable</span>} coll the input collection
<span id="line328" class="lineno">328</span> * <span class="hljs-doctag">@return</span> {<span class="hljs-type">Array|function</span>} the new `Array`, or a bound function
<span id="line329" class="lineno">329</span> * <span class="hljs-doctag">@name</span> <span class="hljs-variable">uniq</span>
<span id="line330" class="lineno">330</span> * <span class="hljs-doctag">@memberof</span> RapidContext.Data
<span id="line331" class="lineno">331</span> *
<span id="line332" class="lineno">332</span> * <span class="hljs-doctag">@example</span>
<span id="line333" class="lineno">333</span> * uniq([1, 2, 3, 3, 2, 1]) //==&gt; [1, 2, 3]
<span id="line334" class="lineno">334</span> * uniq([{ a: 1, b: 2 }, { b: 2, a: 1 }]) //==&gt; [{ a: 1, b: 2 }, { b: 2, a: 1 }]
<span id="line335" class="lineno">335</span> */</span>
<span id="line336" class="lineno">336</span><span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">uniq</span>(<span class="hljs-params">fn, coll</span>) {
<span id="line337" class="lineno">337</span>    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">arguments</span>.<span class="hljs-property">length</span> === <span class="hljs-number">0</span>) {
<span id="line338" class="lineno">338</span>        <span class="hljs-keyword">return</span> [];
<span id="line339" class="lineno">339</span>    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">arguments</span>.<span class="hljs-property">length</span> === <span class="hljs-number">1</span> &amp;&amp; <span class="hljs-title function_">isFunction</span>(fn)) {
<span id="line340" class="lineno">340</span>        <span class="hljs-keyword">return</span> uniq.<span class="hljs-title function_">bind</span>(<span class="hljs-literal">null</span>, fn);
<span id="line341" class="lineno">341</span>    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">arguments</span>.<span class="hljs-property">length</span> === <span class="hljs-number">1</span>) {
<span id="line342" class="lineno">342</span>        coll = <span class="hljs-variable language_">arguments</span>[<span class="hljs-number">0</span>];
<span id="line343" class="lineno">343</span>        fn = <span class="hljs-title class_">JSON</span>.<span class="hljs-property">stringify</span>;
<span id="line344" class="lineno">344</span>    }
<span id="line345" class="lineno">345</span>    <span class="hljs-keyword">let</span> arr = <span class="hljs-title function_">array</span>(coll);
<span id="line346" class="lineno">346</span>    <span class="hljs-keyword">let</span> keys = <span class="hljs-title function_">map</span>(fn, arr).<span class="hljs-title function_">map</span>(<span class="hljs-title class_">String</span>);
<span id="line347" class="lineno">347</span>    <span class="hljs-keyword">return</span> <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">values</span>(<span class="hljs-title function_">object</span>(keys, arr));
<span id="line348" class="lineno">348</span>}
<span id="line349" class="lineno">349</span>
<span id="line350" class="lineno">350</span><span class="hljs-comment">/**
<span id="line351" class="lineno">351</span> * Compares two values to determine relative order. The return value is a
<span id="line352" class="lineno">352</span> * number whose sign indicates the relative order: negative if `a` is less than
<span id="line353" class="lineno">353</span> * `b`, positive if `a` is greater than `b`, or zero if they are equal. If the
<span id="line354" class="lineno">354</span> * first argument is a function, it will be used to extract the values to
<span id="line355" class="lineno">355</span> * compare from the other arguments. Returns a bound function if only a single
<span id="line356" class="lineno">356</span> * argument is specified.
<span id="line357" class="lineno">357</span> *
<span id="line358" class="lineno">358</span> * <span class="hljs-doctag">@param</span> {<span class="hljs-type">function</span>} [valueOf] a function to extract the value
<span id="line359" class="lineno">359</span> * <span class="hljs-doctag">@param</span> {<span class="hljs-type">*</span>} a the first value
<span id="line360" class="lineno">360</span> * <span class="hljs-doctag">@param</span> {<span class="hljs-type">*</span>} [b] the second value
<span id="line361" class="lineno">361</span> * <span class="hljs-doctag">@return</span> {<span class="hljs-type">number|function</span>} the test result, or a bound function
<span id="line362" class="lineno">362</span> * <span class="hljs-doctag">@name</span> <span class="hljs-variable">compare</span>
<span id="line363" class="lineno">363</span> * <span class="hljs-doctag">@memberof</span> RapidContext.Data
<span id="line364" class="lineno">364</span> *
<span id="line365" class="lineno">365</span> * <span class="hljs-doctag">@example</span>
<span id="line366" class="lineno">366</span> * compare(1, 1) //==&gt; 0
<span id="line367" class="lineno">367</span> * compare(13, 42) //==&gt; -1
<span id="line368" class="lineno">368</span> * compare(&#x27;b&#x27;, &#x27;a&#x27;) //==&gt; +1
<span id="line369" class="lineno">369</span> *
<span id="line370" class="lineno">370</span> * <span class="hljs-doctag">@example</span>
<span id="line371" class="lineno">371</span> * compare((s) =&gt; s.toLowerCase(), &#x27;Abc&#x27;, &#x27;aBC&#x27;) //==&gt; 0
<span id="line372" class="lineno">372</span> */</span>
<span id="line373" class="lineno">373</span><span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">compare</span>(<span class="hljs-params">valueOf, a, b</span>) {
<span id="line374" class="lineno">374</span>    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">arguments</span>.<span class="hljs-property">length</span> &lt; <span class="hljs-number">2</span>) {
<span id="line375" class="lineno">375</span>        <span class="hljs-keyword">return</span> compare.<span class="hljs-title function_">bind</span>(<span class="hljs-literal">null</span>, ...<span class="hljs-variable language_">arguments</span>);
<span id="line376" class="lineno">376</span>    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">arguments</span>.<span class="hljs-property">length</span> &lt; <span class="hljs-number">3</span> || !<span class="hljs-title function_">isFunction</span>(valueOf)) {
<span id="line377" class="lineno">377</span>        b = <span class="hljs-variable language_">arguments</span>[<span class="hljs-number">1</span>];
<span id="line378" class="lineno">378</span>        a = <span class="hljs-variable language_">arguments</span>[<span class="hljs-number">0</span>];
<span id="line379" class="lineno">379</span>    } <span class="hljs-keyword">else</span> {
<span id="line380" class="lineno">380</span>        a = <span class="hljs-title function_">valueOf</span>(a);
<span id="line381" class="lineno">381</span>        b = <span class="hljs-title function_">valueOf</span>(b);
<span id="line382" class="lineno">382</span>    }
<span id="line383" class="lineno">383</span>    <span class="hljs-keyword">return</span> a &lt; b ? -<span class="hljs-number">1</span> : (a &gt; b ? <span class="hljs-number">1</span> : <span class="hljs-number">0</span>);
<span id="line384" class="lineno">384</span>}
<span id="line385" class="lineno">385</span>
<span id="line386" class="lineno">386</span><span class="hljs-comment">/**
<span id="line387" class="lineno">387</span> * Returns a sorted copy of a collection. An optional function may be provided
<span id="line388" class="lineno">388</span> * to extract the value to compare with the other elements. If no function is
<span id="line389" class="lineno">389</span> * specified, the comparison is made on the elements themselves. Returns a bound
<span id="line390" class="lineno">390</span> * function if only a single function argument is specified.
<span id="line391" class="lineno">391</span> *
<span id="line392" class="lineno">392</span> * <span class="hljs-doctag">@param</span> {<span class="hljs-type">function</span>} [fn] the value extract function
<span id="line393" class="lineno">393</span> * <span class="hljs-doctag">@param</span> {<span class="hljs-type">Array|Object|Iterable</span>} coll the input collection
<span id="line394" class="lineno">394</span> * <span class="hljs-doctag">@return</span> {<span class="hljs-type">Array|function</span>} the new sorted `Array`, or a bound function
<span id="line395" class="lineno">395</span> * <span class="hljs-doctag">@name</span> <span class="hljs-variable">sort</span>
<span id="line396" class="lineno">396</span> * <span class="hljs-doctag">@memberof</span> RapidContext.Data
<span id="line397" class="lineno">397</span> *
<span id="line398" class="lineno">398</span> * <span class="hljs-doctag">@example</span>
<span id="line399" class="lineno">399</span> * sort([3, 2, 1]) //==&gt; [1, 2, 3]
<span id="line400" class="lineno">400</span> * sort(get(&#x27;pos&#x27;), [{ pos: 3 }, { pos: 1 }]) //==&gt; [{ pos: 1 }, { pos: 3 }]
<span id="line401" class="lineno">401</span> *
<span id="line402" class="lineno">402</span> * <span class="hljs-doctag">@example</span>
<span id="line403" class="lineno">403</span> * const toLower = (s) =&gt; s.toLowerCase();
<span id="line404" class="lineno">404</span> * const sortInsensitive = sort(toLower);
<span id="line405" class="lineno">405</span> * sortInsensitive([&#x27;b&#x27;, &#x27;B&#x27;, &#x27;a&#x27;, &#x27;aa&#x27;, &#x27;A&#x27;]) //==&gt; [&#x27;a&#x27;, &#x27;A&#x27;, &#x27;aa&#x27;, &#x27;b&#x27;, &#x27;B&#x27;]
<span id="line406" class="lineno">406</span> */</span>
<span id="line407" class="lineno">407</span><span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">sort</span>(<span class="hljs-params">fn, coll</span>) {
<span id="line408" class="lineno">408</span>    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">arguments</span>.<span class="hljs-property">length</span> === <span class="hljs-number">0</span>) {
<span id="line409" class="lineno">409</span>        <span class="hljs-keyword">return</span> [];
<span id="line410" class="lineno">410</span>    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">arguments</span>.<span class="hljs-property">length</span> === <span class="hljs-number">1</span> &amp;&amp; <span class="hljs-title function_">isFunction</span>(fn)) {
<span id="line411" class="lineno">411</span>        <span class="hljs-keyword">return</span> sort.<span class="hljs-title function_">bind</span>(<span class="hljs-literal">null</span>, fn);
<span id="line412" class="lineno">412</span>    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">arguments</span>.<span class="hljs-property">length</span> === <span class="hljs-number">1</span>) {
<span id="line413" class="lineno">413</span>        coll = <span class="hljs-variable language_">arguments</span>[<span class="hljs-number">0</span>];
<span id="line414" class="lineno">414</span>        fn = <span class="hljs-literal">null</span>;
<span id="line415" class="lineno">415</span>    }
<span id="line416" class="lineno">416</span>    <span class="hljs-keyword">let</span> arr = <span class="hljs-title function_">array</span>(coll);
<span id="line417" class="lineno">417</span>    arr.<span class="hljs-title function_">sort</span>(fn ? <span class="hljs-title function_">compare</span>(fn) : compare);
<span id="line418" class="lineno">418</span>    <span class="hljs-keyword">return</span> arr;
<span id="line419" class="lineno">419</span>}
<span id="line420" class="lineno">420</span>
<span id="line421" class="lineno">421</span><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> { bool, array, object, clone, get, filter, flatten, map, uniq, compare, sort };
<span id="line422" class="lineno">422</span></code></pre>
        </article>
    </section>





      </div>
    </section>

    <section class="footer center fineprint">
      <hr>
      Copyright &copy; 2007-2023 Per Cederberg. All rights reserved.
    </section>

  </body>
</html>
